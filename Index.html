<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>For You, Always ‚ù§Ô∏è</title>

<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Cormorant+Garamond:ital,wght@0,400;0,600;1,400&family=Montserrat:wght@300;400;600&display=swap" rel="stylesheet">

<style>
:root {
  --primary: #ff4d6d;
  --primary-dark: #c9184a;
  --accent: #ffb3c1;
  --gold: #ffd700;
  --gold-dark: #ffed4e;
  --dark: #590d22;
  --light: #fff0f3;
  --glass: rgba(255, 255, 255, 0.25);
  --glass-border: rgba(255, 255, 255, 0.4);
  --shadow: rgba(255, 77, 109, 0.3);
  
  --transition-smooth: cubic-bezier(0.4, 0, 0.2, 1);
  --transition-bounce: cubic-bezier(0.68, -0.55, 0.265, 1.55);
}

* { margin: 0; padding: 0; box-sizing: border-box; }

html {
  scroll-behavior: smooth;
  scroll-snap-type: y proximity;
}

body {
  font-family: 'Montserrat', sans-serif;
  background: linear-gradient(135deg, #fff0f3 0%, #ffccd5 50%, #fff0f3 100%);
  background-attachment: fixed;
  color: var(--dark);
  overflow-x: hidden;
  min-height: 100vh;
}

/* SCROLL PROGRESS */
.scroll-progress {
  position: fixed;
  top: 0;
  left: 0;
  height: 3px;
  background: linear-gradient(90deg, var(--primary), var(--accent));
  z-index: 10000;
  transition: width 0.1s;
  width: 0%;
}

/* AURORA BACKGROUND */
.aurora {
  position: fixed;
  width: 100vw;
  height: 100vh;
  top: 0;
  left: 0;
  z-index: -2;
  overflow: hidden;
  pointer-events: none;
}

.aurora-blob {
  position: absolute;
  border-radius: 50%;
  filter: blur(80px);
  opacity: 0.6;
  animation: aurora-move 20s infinite alternate var(--transition-smooth);
}

.aurora-blob:nth-child(1) {
  width: 600px;
  height: 600px;
  background: radial-gradient(circle, rgba(255,77,109,0.4), transparent 70%);
  top: -200px;
  left: -200px;
}

.aurora-blob:nth-child(2) {
  width: 500px;
  height: 500px;
  background: radial-gradient(circle, rgba(255,179,193,0.5), transparent 70%);
  bottom: -100px;
  right: -100px;
  animation-delay: -5s;
}

@keyframes aurora-move {
  0% { transform: translate(0, 0) scale(1); }
  33% { transform: translate(50px, -50px) scale(1.1); }
  66% { transform: translate(-30px, 30px) scale(0.9); }
  100% { transform: translate(20px, -20px) scale(1); }
}

/* PARTICLE CANVAS */
#particle-canvas {
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  pointer-events: none;
  z-index: -1;
}

/* NAVIGATION DOTS */
.nav-dots {
  position: fixed;
  right: 30px;
  top: 50%;
  transform: translateY(-50%);
  z-index: 100;
  display: flex;
  flex-direction: column;
  gap: 15px;
}

.nav-dot {
  width: 12px;
  height: 12px;
  border-radius: 50%;
  background: rgba(255, 77, 109, 0.3);
  cursor: pointer;
  transition: all 0.3s var(--transition-smooth);
  position: relative;
}

.nav-dot.active {
  background: var(--primary);
  transform: scale(1.3);
  box-shadow: 0 0 20px rgba(255, 77, 109, 0.6);
}

/* SECTIONS */
section {
  min-height: 100vh;
  display: flex;
  flex-direction: column;
  justify-content: center;
  align-items: center;
  padding: 40px 20px;
  position: relative;
  scroll-snap-align: start;
  opacity: 0;
  transform: translateY(60px);
  transition: all 1s var(--transition-smooth);
}

section.visible {
  opacity: 1;
  transform: translateY(0);
}

/* HERO */
.hero {
  text-align: center;
  position: relative;
  overflow: hidden;
}

.hero-content {
  position: relative;
  z-index: 2;
  max-width: 800px;
}

.glitch-text {
  font-family: 'Cormorant Garamond', serif;
  font-size: clamp(3rem, 10vw, 6rem);
  font-weight: 600;
  color: var(--dark);
  margin-bottom: 20px;
  display: block;
}

.scramble-text {
  font-size: 1.3rem;
  max-width: 600px;
  margin: 0 auto 40px;
  line-height: 1.6;
  min-height: 3.2em;
}

/* BUTTONS */
.magnetic-btn {
  position: relative;
  padding: 18px 48px;
  border-radius: 50px;
  border: none;
  background: linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%);
  color: white;
  font-size: 18px;
  font-weight: 600;
  cursor: pointer;
  box-shadow: 0 10px 30px var(--shadow);
  transition: all 0.3s var(--transition-smooth);
  overflow: hidden;
  display: inline-flex;
  align-items: center;
  gap: 10px;
}

.magnetic-btn:hover {
  transform: translateY(-3px) scale(1.05);
  box-shadow: 0 20px 40px rgba(255, 77, 109, 0.4);
}

/* FLOATING HEARTS */
.floating-hearts {
  position: absolute;
  width: 100%;
  height: 100%;
  pointer-events: none;
  overflow: hidden;
  top: 0;
  left: 0;
}

.heart {
  position: absolute;
  color: var(--primary);
  opacity: 0.3;
  animation: float-up 6s infinite linear;
  font-size: 24px;
  bottom: -50px;
}

@keyframes float-up {
  0% { transform: translateY(0) rotate(0deg) scale(0); opacity: 0; }
  10% { opacity: 0.3; }
  90% { opacity: 0.3; }
  100% { transform: translateY(-100vh) rotate(720deg) scale(1.5); opacity: 0; }
}

/* TIMELINE */
.timeline {
  display: flex;
  gap: 40px;
  justify-content: center;
  flex-wrap: wrap;
  max-width: 1200px;
  width: 100%;
  perspective: 1000px;
}

.timeline-card {
  background: var(--glass);
  backdrop-filter: blur(20px);
  border: 1px solid var(--glass-border);
  padding: 40px 30px;
  border-radius: 24px;
  max-width: 300px;
  text-align: center;
  transition: all 0.5s var(--transition-smooth);
  transform-style: preserve-3d;
}

.timeline-card:hover {
  transform: translateY(-10px) rotateX(5deg);
  box-shadow: 0 30px 60px rgba(255, 77, 109, 0.2);
}

.timeline-icon {
  font-size: 3rem;
  margin-bottom: 20px;
  display: block;
  animation: icon-bounce 2s infinite;
}

@keyframes icon-bounce {
  0%, 100% { transform: translateY(0); }
  50% { transform: translateY(-10px); }
}

.timeline-card h3 {
  font-family: 'Cormorant Garamond', serif;
  font-size: 1.8rem;
  margin-bottom: 15px;
}

/* HORIZONTAL GALLERY SECTION */
.gallery-section {
  padding: 80px 0;
  overflow: hidden;
}

.gallery-header {
  text-align: center;
  margin-bottom: 50px;
  padding: 0 20px;
}

.gallery-header h2 {
  font-family: 'Cormorant Garamond', serif;
  font-size: 3rem;
  margin-bottom: 10px;
}

.gallery-subtitle {
  opacity: 0.8;
  font-size: 1.1rem;
}

.horizontal-gallery {
  display: flex;
  gap: 30px;
  padding: 40px;
  overflow-x: auto;
  scroll-snap-type: x mandatory;
  scroll-behavior: smooth;
  -webkit-overflow-scrolling: touch;
  max-width: 100%;
  position: relative;
}

/* Hide scrollbar */
.horizontal-gallery::-webkit-scrollbar {
  height: 8px;
}

.horizontal-gallery::-webkit-scrollbar-track {
  background: rgba(255, 255, 255, 0.3);
  border-radius: 10px;
}

.horizontal-gallery::-webkit-scrollbar-thumb {
  background: var(--primary);
  border-radius: 10px;
  opacity: 0.5;
}

.gallery-item {
  flex: 0 0 auto;
  width: 300px;
  height: 400px;
  scroll-snap-align: center;
  position: relative;
  transform-style: preserve-3d;
  transition: transform 0.5s var(--transition-smooth);
}

.gallery-item:hover {
  transform: scale(1.05) translateY(-10px);
}

.gallery-frame {
  width: 100%;
  height: 100%;
  background: white;
  padding: 15px;
  border-radius: 15px;
  box-shadow: 0 20px 40px rgba(0,0,0,0.15);
  position: relative;
  overflow: hidden;
}

.gallery-frame img {
  width: 100%;
  height: 75%;
  object-fit: cover;
  border-radius: 10px;
  filter: sepia(10%) saturate(1.1);
  transition: all 0.5s;
}

.gallery-item:hover .gallery-frame img {
  filter: sepia(0%) saturate(1.2);
  transform: scale(1.1);
}

.gallery-caption {
  margin-top: 15px;
  text-align: center;
  font-family: 'Cormorant Garamond', serif;
  font-style: italic;
  font-size: 1.2rem;
  color: var(--dark);
}

/* Gallery Navigation Arrows */
.gallery-nav {
  display: flex;
  justify-content: center;
  gap: 20px;
  margin-top: 30px;
}

.gallery-arrow {
  width: 50px;
  height: 50px;
  border-radius: 50%;
  background: var(--glass);
  border: 2px solid var(--glass-border);
  cursor: pointer;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 1.5rem;
  transition: all 0.3s;
  backdrop-filter: blur(10px);
}

.gallery-arrow:hover {
  background: var(--primary);
  color: white;
  transform: scale(1.1);
}

/* PROPOSAL SECTION */
.proposal {
  text-align: center;
}

.proposal h2 {
  font-family: 'Cormorant Garamond', serif;
  font-size: 2rem;
  margin-bottom: 20px;
  opacity: 0.8;
}

.proposal-question {
  font-family: 'Cormorant Garamond', serif;
  font-size: clamp(2.5rem, 8vw, 4rem);
  margin-bottom: 50px;
  background: linear-gradient(135deg, var(--dark) 0%, var(--primary) 100%);
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
}

.button-container {
  display: flex;
  gap: 30px;
  justify-content: center;
  align-items: center;
  flex-wrap: wrap;
  position: relative;
  min-height: 80px;
}

#noBtn {
  background: transparent;
  color: var(--dark);
  border: 2px solid var(--dark);
  box-shadow: none;
  position: relative;
}

/* GIFT BOX STAGE */
#giftStage {
  position: fixed;
  inset: 0;
  background: rgba(255, 240, 243, 0.98);
  display: flex;
  align-items: center;
  justify-content: center;
  flex-direction: column;
  opacity: 0;
  pointer-events: none;
  transition: opacity 0.8s;
  z-index: 1000;
  backdrop-filter: blur(20px);
}

#giftStage.active {
  opacity: 1;
  pointer-events: all;
}

.gift-hint {
  font-family: 'Cormorant Garamond', serif;
  font-size: 1.5rem;
  margin-bottom: 30px;
  opacity: 0.8;
  animation: pulse-text 2s infinite;
}

@keyframes pulse-text {
  0%, 100% { opacity: 0.8; }
  50% { opacity: 0.4; }
}

/* GIFT BOX CSS ART */
.gift-box-container {
  position: relative;
  width: 200px;
  height: 200px;
  cursor: pointer;
  transform-style: preserve-3d;
  animation: gift-bounce 2s infinite;
  transition: transform 0.3s;
}

.gift-box-container:hover {
  transform: scale(1.1);
}

.gift-box-container.opening {
  animation: gift-shake 0.5s ease-in-out, open-lid 1s forwards;
}

@keyframes gift-bounce {
  0%, 100% { transform: translateY(0); }
  50% { transform: translateY(-20px); }
}

@keyframes gift-shake {
  0%, 100% { transform: rotate(0deg); }
  25% { transform: rotate(-10deg); }
  75% { transform: rotate(10deg); }
}

@keyframes open-lid {
  0% { transform: scale(1); }
  50% { transform: scale(1.2) translateY(-20px); }
  100% { transform: scale(0) rotate(180deg); opacity: 0; }
}

.gift-box {
  width: 150px;
  height: 120px;
  background: linear-gradient(135deg, var(--gold) 0%, var(--gold-dark) 100%);
  position: absolute;
  bottom: 0;
  left: 50%;
  transform: translateX(-50%);
  border-radius: 0 0 10px 10px;
  box-shadow: 0 20px 40px rgba(255, 215, 0, 0.4);
}

.gift-lid {
  width: 170px;
  height: 40px;
  background: linear-gradient(135deg, #ffec8b 0%, var(--gold) 100%);
  position: absolute;
  top: 20px;
  left: 50%;
  transform: translateX(-50%);
  border-radius: 10px;
  box-shadow: 0 5px 15px rgba(0,0,0,0.2);
  z-index: 2;
  transition: transform 0.5s;
}

.gift-box-container.opening .gift-lid {
  transform: translateX(-50%) translateY(-100px) rotate(-20deg);
  opacity: 0;
}

.gift-ribbon-vertical {
  width: 30px;
  height: 120px;
  background: linear-gradient(90deg, #ff6b9d 0%, var(--primary) 100%);
  position: absolute;
  left: 50%;
  transform: translateX(-50%);
  z-index: 1;
}

.gift-ribbon-horizontal {
  width: 150px;
  height: 30px;
  background: linear-gradient(180deg, #ff6b9d 0%, var(--primary) 100%);
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  z-index: 1;
}

.gift-bow {
  position: absolute;
  top: 0;
  left: 50%;
  transform: translateX(-50%);
  width: 60px;
  height: 30px;
  z-index: 3;
}

.bow-left, .bow-right {
  position: absolute;
  width: 30px;
  height: 30px;
  background: var(--primary);
  border-radius: 50% 50% 50% 0;
  top: 0;
}

.bow-left {
  left: 0;
  transform: rotate(-45deg);
}

.bow-right {
  right: 0;
  transform: rotate(135deg);
}

.bow-center {
  position: absolute;
  width: 20px;
  height: 20px;
  background: var(--primary-dark);
  border-radius: 50%;
  top: 5px;
  left: 50%;
  transform: translateX(-50%);
  z-index: 4;
}

/* FINAL MESSAGE REVEAL */
#finalMessage {
  position: fixed;
  inset: 0;
  background: radial-gradient(circle at center, rgba(255,240,243,0.98) 0%, rgba(255,204,213,0.98) 100%);
  display: flex;
  align-items: center;
  justify-content: center;
  flex-direction: column;
  opacity: 0;
  pointer-events: none;
  transition: opacity 1.5s ease;
  z-index: 1001;
  text-align: center;
  padding: 20px;
}

#finalMessage.active {
  opacity: 1;
  pointer-events: all;
}

.message-content {
  transform: scale(0);
  transition: transform 1s var(--transition-bounce);
}

#finalMessage.active .message-content {
  transform: scale(1);
}

.message-text {
  font-family: 'Cormorant Garamond', serif;
  font-size: clamp(2rem, 8vw, 5rem);
  background: linear-gradient(135deg, var(--dark) 0%, var(--primary) 50%, var(--gold) 100%);
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
  background-clip: text;
  margin-bottom: 20px;
  line-height: 1.2;
  text-shadow: 0 10px 30px rgba(255, 77, 109, 0.2);
}

.message-subtext {
  font-size: 1.5rem;
  opacity: 0.8;
  margin-top: 20px;
  font-family: 'Cormorant Garamond', serif;
  font-style: italic;
}

.heart-glow {
  font-size: 4rem;
  display: inline-block;
  animation: heart-beat 1.5s infinite;
  filter: drop-shadow(0 0 20px rgba(255, 77, 109, 0.6));
}

@keyframes heart-beat {
  0%, 100% { transform: scale(1); }
  10%, 30% { transform: scale(1.2); }
  20%, 40% { transform: scale(1); }
}

/* CONFETTI */
#confetti {
  position: absolute;
  inset: 0;
  pointer-events: none;
}

/* SPARKLES FOR GIFT */
.sparkle {
  position: absolute;
  width: 10px;
  height: 10px;
  background: var(--gold);
  border-radius: 50%;
  pointer-events: none;
  opacity: 0;
  animation: sparkle-anim 1s ease-out forwards;
}

@keyframes sparkle-anim {
  0% { transform: translate(0, 0) scale(0); opacity: 1; }
  100% { transform: translate(var(--tx), var(--ty)) scale(0); opacity: 0; }
}

/* RESPONSIVE */
@media (max-width: 768px) {
  .nav-dots { display: none; }
  .timeline { flex-direction: column; align-items: center; }
  .gallery-item { width: 260px; height: 350px; }
  .gift-box-container { transform: scale(0.8); }
}

@media (prefers-reduced-motion: reduce) {
  * { animation-duration: 0.01ms !important; transition-duration: 0.01ms !important; }
  html { scroll-behavior: auto; }
}
</style>
</head>

<body>

<div class="scroll-progress"></div>

<div class="aurora">
  <div class="aurora-blob"></div>
  <div class="aurora-blob"></div>
</div>

<canvas id="particle-canvas"></canvas>

<div class="nav-dots">
  <div class="nav-dot active" data-section="0"></div>
  <div class="nav-dot" data-section="1"></div>
  <div class="nav-dot" data-section="2"></div>
  <div class="nav-dot" data-section="3"></div>
  <div class="nav-dot" data-section="4"></div>
</div>

<!-- Hero -->
<section class="hero visible" data-index="0">
  <div class="floating-hearts" id="floatingHearts"></div>
  <div class="hero-content">
    <h1 class="glitch-text">Hey You ‚ù§Ô∏è</h1>
    <p class="scramble-text" data-final="Some stories are written in the stars. Ours‚Ä¶ I want to write by your side."></p>
    <button class="magnetic-btn" onclick="scrollToSection(1)">
      <span>Begin Our Story</span>
      <span>‚ú®</span>
    </button>
  </div>
</section>

<!-- Story -->
<section id="story" data-index="1">
  <h2 style="font-family: 'Cormorant Garamond', serif; font-size: 3rem; margin-bottom: 60px;">How It All Began</h2>
  <div class="timeline">
    <div class="timeline-card">
      <span class="timeline-icon">‚ú®</span>
      <h3>Fate</h3>
      <p>I didn't know it then‚Ä¶ but my forever was walking right towards me.</p>
    </div>
    <div class="timeline-card">
      <span class="timeline-icon">üíû</span>
      <h3>Connection</h3>
      <p>Talking to you felt like coming home to a place I'd never been.</p>
    </div>
    <div class="timeline-card">
      <span class="timeline-icon">üåπ</span>
      <h3>Love</h3>
      <p>That smile made my heart choose‚Äîwithout hesitation.</p>
    </div>
  </div>
</section>

<!-- Horizontal Gallery (6-8 Photos) -->
<section class="gallery-section" data-index="2">
  <div class="gallery-header">
    <h2>Our Beautiful Moments</h2>
    <p class="gallery-subtitle">Swipe to explore our memories together</p>
  </div>
  
  <div class="horizontal-gallery" id="photoGallery">
    <!-- IMPORTANT: Replace the src URLs below with your direct image links -->
    <!-- Format for Google Drive: https://lh3.googleusercontent.com/d/YOUR_FILE_ID -->
    
    <div class="gallery-item">
      <div class="gallery-frame">
        <img src="https://lh3.googleusercontent.com/d/18u8BbxZSFMHBV9U4e4t8Cf8iOr6Lodr6" alt="First Date">
        <div class="gallery-caption">The First Hello</div>
      </div>
    </div>
    
    <div class="gallery-item">
      <div class="gallery-frame">
        <img src="https://lh3.googleusercontent.com/d/19tyDwuesXypyfObEtx2Mli_y6EIHWH4T" alt="Sunset">
        <div class="gallery-caption">Golden Hour With You</div>
      </div>
    </div>
    
    <div class="gallery-item">
      <div class="gallery-frame">
        <img src="https://lh3.googleusercontent.com/d/130pM5o5zrjNWlkQe6HC4OW2CbjQwVl7e" alt="Laughing">
        <div class="gallery-caption">Your Beautiful Smile</div>
      </div>
    </div>
    
    <div class="gallery-item">
      <div class="gallery-frame">
        <img src="https://lh3.googleusercontent.com/d/1KgoDldO5Ggewhe3XrffGSZAImUGNWHtN" alt="Holding hands">
        <div class="gallery-caption">Never Letting Go</div>
      </div>
    </div>
    
    <div class="gallery-item">
      <div class="gallery-frame">
        <img src="https://lh3.googleusercontent.com/d/1J0yaYcSo6Q5TukJ15njZrjn1Dt_nAucJ" alt="Coffee date">
        <div class="gallery-caption">Coffee & Conversations</div>
      </div>
    </div>
    
    <div class="gallery-item">
      <div class="gallery-frame">
        <img src="https://lh3.googleusercontent.com/d/1ugoJ8VcaBufldcpu26D7NOeeQfiYrUUd" alt="Adventure">
        <div class="gallery-caption">Our Adventures</div>
      </div>
    </div>
    
    <div class="gallery-item">
      <div class="gallery-frame">
        <img src="https://lh3.googleusercontent.com/d/1EB4VY1Xh_C3DejbrsBJC_dFi_tbtFN_-" alt="Dancing">
        <div class="gallery-caption">Dancing Under Stars</div>
      </div>
    </div>
    
    <div class="gallery-item">
      <div class="gallery-frame">
        <img src="https://lh3.googleusercontent.com/d/1VMlPJ_OV9-IbzBjDlGoq9a_Xf2-qMYqq" alt="Forever">
        <div class="gallery-caption">Forever Begins Here</div>
      </div>
    </div>
  </div>

  <div class="gallery-nav">
    <button class="gallery-arrow" onclick="scrollGallery(-1)">‚Üê</button>
    <button class="gallery-arrow" onclick="scrollGallery(1)">‚Üí</button>
  </div>
</section>

<!-- Proposal -->
<section class="proposal" data-index="3">
  <h2>One Question‚Ä¶</h2>
  <h1 class="proposal-question">Will You Be My Valentine? üåπ</h1>
  <div class="button-container">
    <button class="magnetic-btn" onclick="showGift()">
      <span>Yes, Forever</span>
      <span>‚ù§Ô∏è</span>
    </button>
    <button class="magnetic-btn" id="noBtn">
      <span>No</span>
    </button>
  </div>
</section>

<!-- GIFT STAGE (Appears after Yes) -->
<div id="giftStage">
  <p class="gift-hint">Tap the gift to reveal your surprise...</p>

  <div class="gift-box-container" id="giftBox" onclick="openGift()">
    <div class="gift-lid">
      <div class="gift-ribbon-vertical" style="height: 40px; top: 0;"></div>
    </div>
    <div class="gift-box">
      <div class="gift-ribbon-vertical"></div>
      <div class="gift-ribbon-horizontal"></div>
    </div>
    <div class="gift-bow">
      <div class="bow-left"></div>
      <div class="bow-right"></div>
      <div class="bow-center"></div>
    </div>
  </div>
</div>

<!-- FINAL MESSAGE STAGE -->
<div id="finalMessage">
  <canvas id="confetti"></canvas>
  <div class="message-content">
    <div class="heart-glow">‚ù§Ô∏è</div>
    <h1 class="message-text">I love you<br>my sun and moon</h1>
    <p class="message-subtext">You are my everything, today and always</p>
    <button class="magnetic-btn" onclick="resetAll()" style="margin-top: 40px;">
      Open My Heart Again
    </button>
  </div>
</div>

<script>
// ==================== UTILITIES ====================
const $ = (sel) => document.querySelector(sel);
const $$ = (sel) => document.querySelectorAll(sel);

// ==================== SCROLL PROGRESS ====================
const scrollProgress = $('.scroll-progress');
window.addEventListener('scroll', () => {
  const scrolled = window.scrollY / (document.documentElement.scrollHeight - window.innerHeight);
  scrollProgress.style.width = `${scrolled * 100}%`;
});

// ==================== SCROLL REVEAL ====================
const observer = new IntersectionObserver((entries) => {
  entries.forEach(entry => {
    if (entry.isIntersecting) {
      entry.target.classList.add('visible');
      const index = entry.target.dataset.index;
      if (index !== undefined) updateNavDots(index);
    }
  });
}, { threshold: 0.2 });

$$('section').forEach(section => observer.observe(section));

// ==================== NAVIGATION ====================
const dots = $$('.nav-dot');
function updateNavDots(activeIndex) {
  dots.forEach((dot, idx) => dot.classList.toggle('active', idx == activeIndex));
}

dots.forEach((dot, idx) => {
  dot.addEventListener('click', () => scrollToSection(idx));
});

function scrollToSection(index) {
  const sections = $$('section');
  if (sections[index]) sections[index].scrollIntoView({ behavior: 'smooth' });
}

// ==================== TEXT SCRAMBLE ====================
class TextScramble {
  constructor(el) {
    this.el = el;
    this.chars = '!<>-_\\/[]{}‚Äî=+*^?#________';
    this.update = this.update.bind(this);
  }
  
  setText(newText) {
    const oldText = this.el.innerText;
    const length = Math.max(oldText.length, newText.length);
    const promise = new Promise((resolve) => this.resolve = resolve);
    this.queue = [];
    for (let i = 0; i < length; i++) {
      const from = oldText[i] || '';
      const to = newText[i] || '';
      const start = Math.floor(Math.random() * 40);
      const end = start + Math.floor(Math.random() * 40);
      this.queue.push({ from, to, start, end });
    }
    cancelAnimationFrame(this.frameRequest);
    this.frame = 0;
    this.update();
    return promise;
  }
  
  update() {
    let output = '';
    let complete = 0;
    for (let i = 0, n = this.queue.length; i < n; i++) {
      let { from, to, start, end, char } = this.queue[i];
      if (this.frame >= end) {
        complete++;
        output += to;
      } else if (this.frame >= start) {
        if (!char || Math.random() < 0.28) {
          char = this.randomChar();
          this.queue[i].char = char;
        }
        output += `<span style="opacity:0.5;">${char}</span>`;
      } else {
        output += from;
      }
    }
    this.el.innerHTML = output;
    if (complete === this.queue.length) this.resolve();
    else {
      this.frameRequest = requestAnimationFrame(this.update);
      this.frame++;
    }
  }
  
  randomChar() {
    return this.chars[Math.floor(Math.random() * this.chars.length)];
  }
}

const scrambleEl = $('.scramble-text');
const fx = new TextScramble(scrambleEl);
setTimeout(() => fx.setText(scrambleEl.dataset.final), 1000);

// ==================== MAGNETIC BUTTONS ====================
$$('.magnetic-btn').forEach(btn => {
  btn.addEventListener('mousemove', (e) => {
    const rect = btn.getBoundingClientRect();
    const x = e.clientX - rect.left - rect.width / 2;
    const y = e.clientY - rect.top - rect.height / 2;
    btn.style.transform = `translate(${x * 0.3}px, ${y * 0.3}px) scale(1.05)`;
  });
  
  btn.addEventListener('mouseleave', () => {
    btn.style.transform = 'translate(0, 0) scale(1)';
  });
});

// ==================== RUNAWAY NO BUTTON ====================
const noBtn = $('#noBtn');
let noAttempts = 0;

function moveNoButton() {
  const container = $('.button-container');
  const rect = container.getBoundingClientRect();
  const maxX = rect.width / 2 - 50;
  const maxY = rect.height / 2 + 50;
  const x = (Math.random() - 0.5) * maxX * 2;
  const y = (Math.random() - 0.5) * maxY * 2;
  
  noBtn.style.position = 'absolute';
  noBtn.style.left = `calc(50% + ${x}px)`;
  noBtn.style.top = `calc(50% + ${y}px)`;
  noBtn.style.transform = 'translate(-50%, -50%)';
  
  noAttempts++;
  if (noAttempts > 3) {
    noBtn.innerHTML = '<span>Okay Fine üò¢</span>';
    noBtn.style.opacity = '0.5';
  }
}

noBtn.addEventListener('mouseover', moveNoButton);
noBtn.addEventListener('touchstart', (e) => { e.preventDefault(); moveNoButton(); });

// ==================== HORIZONTAL GALLERY ====================
const gallery = $('#photoGallery');
function scrollGallery(direction) {
  const scrollAmount = 330; // card width + gap
  gallery.scrollBy({ left: scrollAmount * direction, behavior: 'smooth' });
}

// Drag to scroll functionality
let isDown = false;
let startX;
let scrollLeft;

gallery.addEventListener('mousedown', (e) => {
  isDown = true;
  startX = e.pageX - gallery.offsetLeft;
  scrollLeft = gallery.scrollLeft;
});

gallery.addEventListener('mouseleave', () => { isDown = false; });
gallery.addEventListener('mouseup', () => { isDown = false; });

gallery.addEventListener('mousemove', (e) => {
  if (!isDown) return;
  e.preventDefault();
  const x = e.pageX - gallery.offsetLeft;
  const walk = (x - startX) * 2;
  gallery.scrollLeft = scrollLeft - walk;
});

// ==================== GIFT BOX LOGIC ====================
function showGift() {
  $('#giftStage').classList.add('active');
  createSparkles();
}

function createSparkles() {
  const container = $('#giftStage');
  for (let i = 0; i < 20; i++) {
    setTimeout(() => {
      const sparkle = document.createElement('div');
      sparkle.className = 'sparkle';
      sparkle.style.left = Math.random() * 100 + '%';
      sparkle.style.top = Math.random() * 100 + '%';
      sparkle.style.setProperty('--tx', (Math.random() - 0.5) * 200 + 'px');
      sparkle.style.setProperty('--ty', (Math.random() - 0.5) * 200 + 'px');
      container.appendChild(sparkle);
      setTimeout(() => sparkle.remove(), 1000);
    }, i * 100);
  }
}

function openGift() {
  const giftBox = $('#giftBox');
  giftBox.classList.add('opening');

  setTimeout(() => {
    $('#giftStage').classList.remove('active');
    $('#finalMessage').classList.add('active');
    startConfetti();
  }, 1000);
}

// ==================== CONFETTI SYSTEM ====================
const confettiCanvas = $('#confetti');
const cCtx = confettiCanvas.getContext('2d');
let confetti = [];
let animationId;

function resizeConfetti() {
  confettiCanvas.width = window.innerWidth;
  confettiCanvas.height = window.innerHeight;
}
resizeConfetti();
window.addEventListener('resize', resizeConfetti);

class ConfettiPiece {
  constructor() {
    this.reset();
  }
  
  reset() {
    this.x = Math.random() * confettiCanvas.width;
    this.y = -20;
    this.size = Math.random() * 10 + 5;
    this.speedY = Math.random() * 3 + 2;
    this.speedX = (Math.random() - 0.5) * 2;
    this.rotation = Math.random() * 360;
    this.rotationSpeed = (Math.random() - 0.5) * 10;
    this.color = ['#ff4d6d', '#ffb3c1', '#ff8fa3', '#c9184a', '#ffccd5', '#ffd700'][Math.floor(Math.random() * 6)];
    this.shape = Math.random() > 0.5 ? 'rect' : 'heart';
  }
  
  update() {
    this.y += this.speedY;
    this.x += this.speedX + Math.sin(this.y * 0.01) * 0.5;
    this.rotation += this.rotationSpeed;
    if (this.shape === 'heart') this.speedY += 0.02;
  }
  
  draw() {
    cCtx.save();
    cCtx.translate(this.x, this.y);
    cCtx.rotate((this.rotation * Math.PI) / 180);
    cCtx.fillStyle = this.color;
    
    if (this.shape === 'rect') {
      cCtx.fillRect(-this.size/2, -this.size/2, this.size, this.size);
    } else {
      const s = this.size;
      cCtx.beginPath();
      cCtx.moveTo(0, -s/2);
      cCtx.bezierCurveTo(s/2, -s, s, -s/2, 0, s);
      cCtx.bezierCurveTo(-s, -s/2, -s/2, -s, 0, -s/2);
      cCtx.fill();
    }
    cCtx.restore();
  }
}

function startConfetti() {
  confetti = [];
  for (let i = 0; i < 150; i++) {
    setTimeout(() => confetti.push(new ConfettiPiece()), i * 10);
  }
  
  let interval = setInterval(() => {
    if (!$('#finalMessage').classList.contains('active')) {
      clearInterval(interval);
      return;
    }
    confetti.push(new ConfettiPiece());
  }, 100);
  
  setTimeout(() => clearInterval(interval), 4000);
  animateConfetti();
}

function animateConfetti() {
  if (!$('#finalMessage').classList.contains('active')) return;
  cCtx.clearRect(0, 0, confettiCanvas.width, confettiCanvas.height);
  confetti = confetti.filter(p => p.y < confettiCanvas.height + 20);
  confetti.forEach(p => { p.update(); p.draw(); });
  animationId = requestAnimationFrame(animateConfetti);
}

function resetAll() {
  $('#finalMessage').classList.remove('active');
  $('#giftBox').classList.remove('opening');
  noAttempts = 0;
  noBtn.style.position = 'relative';
  noBtn.style.left = 'auto';
  noBtn.style.top = 'auto';
  noBtn.style.transform = 'none';
  noBtn.style.opacity = '1';
  noBtn.innerHTML = '<span>No</span>';
  cCtx.clearRect(0, 0, confettiCanvas.width, confettiCanvas.height);
  cancelAnimationFrame(animationId);
}

// ==================== FLOATING HEARTS ====================
function createFloatingHeart() {
  const container = $('#floatingHearts');
  const heart = document.createElement('div');
  heart.className = 'heart';
  heart.innerHTML = '‚ù§Ô∏è';
  heart.style.left = Math.random() * 100 + '%';
  heart.style.animationDuration = (Math.random() * 3 + 4) + 's';
  heart.style.opacity = Math.random() * 0.5 + 0.1;
  heart.style.fontSize = (Math.random() * 20 + 10) + 'px';
  container.appendChild(heart);
  setTimeout(() => heart.remove(), 7000);
}
setInterval(createFloatingHeart, 300);

// ==================== PARTICLE BACKGROUND ====================
const canvas = $('#particle-canvas');
const ctx = canvas.getContext('2d');
let particles = [];

function resizeCanvas() {
  canvas.width = window.innerWidth;
  canvas.height = window.innerHeight;
}
resizeCanvas();
window.addEventListener('resize', resizeCanvas);

class Particle {
  constructor() {
    this.reset();
    this.y = Math.random() * canvas.height;
  }
  
  reset() {
    this.x = Math.random() * canvas.width;
    this.y = canvas.height + 10;
    this.size = Math.random() * 3 + 1;
    this.speedY = Math.random() * 1 + 0.5;
    this.speedX = (Math.random() - 0.5) * 0.5;
    this.opacity = Math.random() * 0.5 + 0.2;
    this.color = `rgba(255, ${Math.floor(Math.random() * 100 + 77)}, ${Math.floor(Math.random() * 50 + 109)},`;
  }
  
  update() {
    this.y -= this.speedY;
    this.x += this.speedX + Math.sin(this.y * 0.01) * 0.5;
    if (this.y < -10) this.reset();
  }
  
  draw() {
    ctx.fillStyle = this.color + this.opacity + ')';
    ctx.beginPath();
    ctx.arc(this.x, this.y, this.size, 0, Math.PI * 2);
    ctx.fill();
  }
}

for (let i = 0; i < 50; i++) particles.push(new Particle());

function animateParticles() {
  ctx.clearRect(0, 0, canvas.width, canvas.height);
  particles.forEach(p => { p.update(); p.draw(); });
  requestAnimationFrame(animateParticles);
}
animateParticles();

// ==================== PARALLAX ====================
window.addEventListener('scroll', () => {
  const scrolled = window.pageYOffset;
  $$('.aurora-blob').forEach((el, idx) => {
    const speed = 0.5 + (idx * 0.2);
    el.style.transform = `translateY(${scrolled * speed}px)`;
  });
});
</script>

</body>
</html>
